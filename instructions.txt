<!DOCTYPE html><meta charset=utf-8><title>Descent Control</title><meta content=\"width=device-width,initial-scale=0.5,maximum-scale=0.5\"name=viewport><script src=https://code.jquery.com/jquery-3.2.1.min.js crossorigin=anonymous integrity=\"sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=\"></script><script src=../dist/nipplejs.js charset=utf-8></script><style>body,html{position:absolute;top:0;left:0;right:0;bottom:0;padding:0;margin:0;background:rgba(0,255,0,.1)}#stick1{width:100%;height:100%}</style><div id=stick1></div><script>function bindNipple(){joystick.on(\"start end\",function(e,t){setCenter(t)}).on(\"move\",function(e,t){setDelta(t),sendPos()}).on(\"dir:up plain:up dir:left plain:left dir:down plain:down dir:right plain:right\",function(e,t){}).on(\"pressure\",function(e,t){})}function sendPos(){setTimeout(function(){(Math.abs(pos.xPercentLast-pos.xPercent)>=settings.sendThreshold||Math.abs(pos.yPercentLast-pos.yPercent)>=settings.sendThreshold)&&($.ajax({type:\"post\",url:\"/servo/percent\",data:{x:pos.xPercent,y:pos.yPercent},success:function(e){}}),pos.xPercentLast=pos.xPercent,pos.yPercentLast=pos.yPercent,console.log(\"Sent\"))},0)}function setCenter(e){pos={jRadius:e.options.size/2,xCenter:e.position.x,yCenter:e.position.y,xDelta:0,yDelta:0,xPercent:0,yPercent:0,xPercentLast:0,yPercentLast:0}}function setDelta(e){setTimeout(function(){pos.xDelta=Math.min(pos.jRadius,e.position.x-pos.xCenter),pos.yDelta=Math.min(pos.jRadius,e.position.y-pos.yCenter),pos.xPercent=Math.round(pos.xDelta/pos.jRadius*100),pos.yPercent=Math.round(pos.yDelta/pos.jRadius*100)},0)}var pos={jRadius:0,xCenter:0,yCenter:0,xDelta:0,yDelta:0,xPercent:0,yPercent:0,xPercentLast:0,yPercentLast:0},settings={sendThreshold:5,sendURL:\"/servo/percent\"},joystick=nipplejs.create({zone:document.getElementById(\"stick1\"),mode:\"semi\",position:{left:\"0\",top:\"0\"},color:\"green\",size:200});bindNipple()</script>